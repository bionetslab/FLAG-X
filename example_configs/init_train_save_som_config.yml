
# flagx init-train-save --config ./configs/init_train_save_som_config.yml

save_dir: "./results/test_cli/som"
pipeline_filename: "gating_pipeline_som_trained.pkl"

train_data_file_path: "./tests/test_data"
train_data_file_names: null  # Use all files in the dir for training
train_data_file_type: "fcs"

channels: ["FS INT", "SS INT", "16-FITC", "56-PE", "3-ECD", "4-PC7", "19-APC", "14-APC700", "8-PB", "45-CO"]
label_key: "population"

compensate: false

channel_names_alignment_kwargs:
  reference_channel_names: 0  # Use the 1st file that is loaded as reference for the channel names

relabel_data_kwargs:  # No relabeling, keep the original labels ({'old_to_new_label_mapping': Dict, 'new_label_key': str})
  old_to_new_label_mapping:
    1: 0
    2: 1
    3: 2
    4: 3
    5: 4
    6: 5
    7: 6
    8: 7
  new_label_key: 'population_relabeled'

preprocessing_kwargs:
  flavour: "log10_w_custom_cutoffs"
  flavour_kwargs:
    cutoffs:
      FS INT: 100000
      SS INT: 20000
      16-FITC: 250
      56-PE: 450
      3-ECD: 700
      4-PC7: 1200
      19-APC: 1700
      14-APC700: 900
      8-PB: 450
      45-CO: 500

downsampling_kwargs:
  target_num_events: 10000
  stratified: true

gating_method: "som"
gating_method_kwargs:
  som_topology: "planar"
  som_grid_type: "rectangular"
  som_dimensions: [6, 6]
  neighborhood: "gaussian"
  gaussian_neighborhood_sigma: 0.1
  initialization: "pca"
  initial_codebook: null
  n_epochs: 10
  radius_0: -0.5
  radius_n: 0.1
  radius_cooling: "exponential"
  learning_rate_0: 0.1
  learning_rate_n: 0.001
  learning_rate_decay: "exponential"
  verbosity: 2
prediction_threshold: null  # Use default (argmax across class probabilities for multiclass case, threshold 0.5 for binary case)

verbosity: 1







